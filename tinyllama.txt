import streamlit as st
import streamlit.components.v1 as components

# Function to execute when button is clicked
def my_function():
    st.write("Button was clicked! Function executed.")

# Initialize session state if it doesn't exist
if 'button_clicked' not in st.session_state:
    st.session_state.button_clicked = False

# HTML button that uses JavaScript to trigger a Python action
button_html = """
    <button onclick="triggerPythonFunction()">Click Me!</button>
    <script>
        function triggerPythonFunction() {
            // Update the session state and reload the page
            window.location.href = window.location.href + "?button_clicked=true";
        }
    </script>
"""

# Embed the HTML button in the Streamlit app
components.html(button_html)

# Check if the button was clicked using query parameters
if st.experimental_get_query_params().get('button_clicked'):
    st.session_state.button_clicked = True
    st.experimental_rerun()  # Reload the page to apply session state changes

# Trigger the function if the button was clicked
if st.session_state.button_clicked:
    my_function()
    # Optionally reset the session state to allow clicking again
    st.session_state.button_clicked = False
